<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <link href="./styles/css/main.css" rel="stylesheet" type="text/css">
    <title>Rabbitwave Vlogger</title>
  </head>
  <body>

    <!-- Settings panel -->
    <div class="dark-overlay hidden" id="settings-panel">
      <div class="popup">

        <!-- Devicces -->
        <div class="selector">
          <div>Video input device:</div>
            <select id="camera-selector" class="fullwidth"></select>
        </div>

        <div class="selector">
          <div>Audio input device:</div>
            <select id="mic-selector" class="fullwidth"></select>
        </div>

        <div class="selector">
          <div>Audio output device:</div>
            <select id="output-selector" class="fullwidth"></select>
        </div>

        <div class="selector">
          <div>Video resolution:</div>
            <select id="resolution-selector" class="fullwidth">
              <optgroup label="4:3">
                <option value="640x480">640 × 480</option>
                <option value="800x600">800 × 600</option>
                <option value="1024x768">1024 × 768</option>
                <option value="1280x960">1280 × 960</option>
                <option value="1600x1200">1600 × 1200</option>
              </optgroup>
              <optgroup label="16:9">
                <option value="852x480">852 × 480</option>
                <option value="1280x720" selected>1280 × 720</option>
                <option selected value="1920x1080">1920 × 1080</option>
              </optgroup>
            </select>
        </div>

        <div class="selector-row">

          <div class="selector">
            <div>Video codec:</div>
              <select id="video-codec-selector">
                <option value="video/mp4">MP4</option>
                <option value="video/webm;codecs=vp9">WEBM, WP9</option>
                <option value="video/webm;codecs=vp8">WEBM, WP8</option>
                <option selected value="video/webm;codecs=h264">WEBM, H264</option>
                <option value="video/x-matroska;codecs=avc1">Matroska, AVC1</option>
              </select>
          </div>
          
          <div class="selector">
              <div>Video bitrate, kbps</div>
              <input type="number" value="5000" id="video-bitrate-selector" min="500" max="50000" />
          </div>              
        
          <div class="selector">
              <div>Audio bitrate, kbps</div>
              <input type="number" value="1400" id="audio-bitrate-selector" min="128" max="9600" />
          </div>

        </div>
          
        <div class="selector">
            <div>Default filename (you can change it when saving, if necessary)</div>
            <input type="text" value="vlog.webp" id="filename-selector" class="fullwidth" />
        </div>

        <div class="selector">
          <div class="row">
            <input type="button" class="text-button" id="btn_refresh_devices" value="Refresh devices" />
            <input type="button" class="text-button" id="btn_save_settings" value="Save settings" />
            <input type="button" class="text-button" id="btn_load_settings" value="Load settings" />
            <input type="button" class="text-button" id="btn_close_settings" value="Close" />
          </div>
        </div>        

      </div>
    </div>

    <!-- Video asset option panel -->
    <div class="dark-overlay hidden" id="videoasset-options-panel">
      <div class="popup">

        <input type="hidden" id="asset_option_id" />
        <input type="hidden" id="asset_option_type" />

        <div class="selector">
            <div>Name of asset:</div>
            <input type="text" value="" id="asset_option_name" class="fullwidth" />
        </div>

        <div class="selector options_image options_video options_audio">
            <div>Full file path:</div>
            <div class="fullwidth">
              <input type="text" disabled class="flex-grow" value="" id="asset_option_filename" />
              <button id="btn_asset_new_file"><i class="fa fa-solid fa-folder-open"></i></button>
            </div>
        </div>

        <div class="selector options_text">
            <div>Text:</div>
            <textarea id="asset_option_text" class="fullwidth"></textarea>
        </div>

        <div class="selector options_image options_video options_audio">
            <div>Description, notes:</div>
            <textarea id="asset_option_description" class="fullwidth"></textarea>
        </div>

        <div class="selector-row options_text">

          <div class="selector">
              <div>Font:</div>
              <select id="asset_option_font">
                  <option value="Helvetica">Helvetica</option>
                  <option value="Arial">Arial</option>
                  <option value="Courier New">Courier New</option>
                  <option value="Menlo">Menlo</option>
                  <option value="Garamond">Garamond</option>
                  <option value="Comic Sans">Comic Sans</option>
              </select>
          </div>

          <div class="selector">
              <div>Font size:</div>
              <input type="number" value="12" min="6" max="72" id="asset_option_font_size" />
          </div>
          
          <div class="selector">
              <div>Alignment:</div>
              <select id="asset_option_align">
                  <option value="left">Left</option>
                  <option value="center">Center</option>
                  <option value="right">Right</option>
              </select>
          </div>

          <div class="selector">
              <div>Line height:</div>
              <input type="number" value="15" min="1" max="255" id="asset_option_line_height" />
          </div>          
        </div>    

        <div class="selector options_image options_text">
            <div>Display time, seconds:<br />(0 for no timeout)</div>
            <input type="number" value="0" min="0" max="120" id="asset_option_display_time" />
        </div>

        <div class="selector options_video options_audio">
            <div>Volume:</div>
            <input type="number" value="50" min="0" max="100" id="asset_option_volume" />
        </div>          
        
        <div class="selector options_image options_video options_text">
          <div>Position, X, Y (ignored if centered):</div>
          <input type="number" value="0" min="-5000" max="5000" id="asset_option_x" /> ; <input type="number" value="0" min="-5000" max="5000" id="asset_option_y" />
        </div>
        
        <div class="selector-row options_video options_audio">
          <div class="selector">
            <div>Start time:</div>
            <input type="number" value="0" min="0" max="23" id="asset_option_start_hour" /> :
            <input type="number" value="0" min="0" max="59" id="asset_option_start_minute" /> :
            <input type="number" value="0" min="0" max="59" id="asset_option_start_second" />
          </div>

          <div class="selector">
            <div>End time (0 means to the end):</div>
            <input type="number" value="0" min="0" max="23" id="asset_option_end_hour" /> :
            <input type="number" value="0" min="0" max="59" id="asset_option_end_minute" /> :
            <input type="number" value="0" min="0" max="59" id="asset_option_end_second" />
          </div>          
        </div>

        <!-- Checkboxes -->
          <div class="checkbox-selector">
            <div class="options_text"><input type="checkbox" id="asset_option_outline" checked /><label for="asset_option_outline">Black outline</label></div>
            <div class="options_image options_video"><input type="checkbox" id="asset_option_resize_big" /><label for="asset_option_resize_big">Resize if too big</label></div>
            <div class="options_image options_video"><input type="checkbox" id="asset_option_resize_small" /><label for="asset_option_resize_small">Resize if too small</label></div>
            <div class="options_image options_video"><input type="checkbox" id="asset_option_center" /><label for="asset_option_center">Center</label></div>
            <div class="options_text"><input type="checkbox" checked id="asset_option_horizontal_center" /><label for="asset_option_horizontal_center">Horizontal center</label></div>
            <div class="options_text"><input type="checkbox" id="asset_option_vertical_center" /><label for="asset_option_vertical_center">Vertical center</label></div>
            <div class="options_image options_video"><input type="checkbox" id="asset_option_black" /><label for="asset_option_black">Black background</label></div>
            <div class="options_video"><input type="checkbox" id="asset_option_fade" /><label for="asset_option_fade">Fade in and out</label></div>
            <div class="options_video"><input type="checkbox" id="asset_option_mute" /><label for="asset_option_mute">Mute</label></div>
            <div class="options_video"><input type="checkbox" id="asset_option_hide_when_ended" /><label for="asset_option_hide_when_ended">Hide when ended</label></div>
            <div class="options_audio options_video"><input type="checkbox" id="asset_option_loop" /><label for="asset_option_loop">Loop</label></div>
            <div class="options_audio options_video"><input type="checkbox" id="asset_option_mic_off" /><label for="asset_option_mic_off">Microphone off</label></div>
        </div>   

        <div class="selector">
          <div class="row">
            <input type="button" class="text-button" id="btn_accept_asset_changes" value="Accept" />
            <input type="button" class="text-button" id="btn_close_asset_options" value="Cancel" />
          </div>
        </div>        

      </div>
    </div>

    <div class="mainwindow">

      <!-- Camera preview -->
      <div class="left-side">

        <div class="camera-image">
          <canvas id="video-canvas"></canvas>
          <div id="btn_preview_close" class="hidden"><i class="fa fa-solid fa-times"></i></div>
          <img id="preview-image" class="preview hidden" />
          <video id="preview-video" class="preview hidden" controls></video>
          <audio id="preview-audio" class="preview hidden" controls></audio>
        </div>

      </div>

      <!-- Right side panel -->
      <div class="right-side">

        <!-- Media files list -->
        <div class="asset-list-wrapper">
          <select id="asset-list" multiple size="10"></select>
          <div class="asset-list-move-buttons">
            <button id="btn_asset_up" alt="Move asset(s) up"><i class="fa fa-solid fa-arrow-alt-up"></i></button>

            <div>
              <button id="btn_asset_load" alt="Load saved asset list"><i class="fa fa-solid fa-folder-open"></i></button>
              <button id="btn_asset_save" alt="Save asset list"><i class="fa fa-solid fa-save"></i></button>
              <button id="btn_open_settings" alt="App settings"><i class="fa fa-solid fa-cog"></i></button>            
            </div>

            <button id="btn_asset_down" alt="Move asset(s) down"><i class="fa fa-solid fa-arrow-alt-down"></i></button>
          </div>
        </div>

        <div class="asset-list-buttons">

          <!-- Video and audio player controls -->
          <div id="video_controls" class="hidden">
            <div class="video_controls_row">
              <div class="video_controls_btngroup">
                  <button id="btn_video_play_pause"><i id="icon_video_play_pause" class="fa fa-solid fa-play"></i></button>
                  <button id="btn_video_stop"><i class="fa fa-solid fa-stop"></i></button>
                  <button id="btn_video_eject"><i class="fa fa-solid fa-eject"></i></button>
              </div>
              <div class="video_controls_btngroup">
                  <button id="btn_video_mute"><i id="video_mute_icon" class="fa fa-solid fa-volume"></i></button>
                  <input type="range" min="1" max="100" value="50" id="video_volume">
              </div>
            </div>
            
            <div class="video_controls_row">
              <input type="range" min="0" max="100" value="0" id="video_progress">
              <div id="video_time">00:00:00</div>
            </div>
          </div>

          <div id="image_controls" class="hidden">
            <button id="btn_image_hide" alt="Hide overlays"><i class="fa fa-solid fa-eye-slash"></i></button>
          </div>

          <div id="asset_controls">
            <button id="btn_asset_new" alt="Add new asset"><i class="fa fa-solid fa-plus"></i></button>
            <button id="btn_asset_text" alt="Add text"><i class="fa fa-solid fa-text"></i></button>
            <button id="btn_asset_clone" alt="Clone asset"><i class="fa fa-solid fa-clone"></i></button>
            <button id="btn_asset_delete" alt="Remove asset"><i class="fa fa-solid fa-trash-alt"></i></button>
            <button id="btn_asset_settings" alt="Asset settings"><i class="fa fa-solid fa-sliders-h"></i></button>
          </div>

          <div id="record_controls" class="recording">
            <div>
              <div id="record_time" alt="Recording length">00:00:00</div>
              <div id="record_resolution" alt="Resolution, video and audio bitrate">No resolution data</div>
            </div>
            <button id="btn_record" alt="Record" class="recording"><i class="fa fa-solid fa-circle"></i></button>
          </div>

        </div>

        <textarea id="notes" placeholder="Write notes here"></textarea>

      </div>

    </div>

    <script type="text/javascript" src="./index.js"></script>
    <script type="text/javascript" src="./renderer.js"></script>
    <script src="./scripts/RecordRTC.js"></script>

  </body>
</html>
